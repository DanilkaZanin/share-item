# Фаза 2. Проектирование архитектуры и структуры системы

## 1. Назначение фазы

Целью второй фазы является формирование архитектурного облика сервиса шеринга предметов, определение основных компонентов системы, их ответственности и взаимодействия. На данном этапе фиксируются ключевые архитектурные решения, которые будут использованы на последующих стадиях разработки и оценки проекта.

---

## 2. Общий обзор системы

Проектируемая система представляет собой backend-сервис, предназначенный для организации совместного использования предметов между пользователями. Сервис предоставляет API для управления пользователями, предметами, операциями шеринга и связанными с ними ресурсами.

Система ориентирована на работу в распределённой среде и развёртывается в контейнерах с использованием Docker.

---

## 3. Архитектурный стиль

В качестве базового архитектурного подхода выбран **слоистый (layered) архитектурный стиль**, реализованный в рамках Spring Boot приложения.

Выделены следующие логические слои:

- **API слой (Controller layer)**  
  Обрабатывает HTTP-запросы, выполняет валидацию входных данных и возвращает ответы клиенту.

- **Сервисный слой (Service layer)**  
  Содержит бизнес-логику приложения, правила доступа и сценарии работы с предметами.

- **Слой доступа к данным (Repository layer)**  
  Отвечает за взаимодействие с реляционной базой данных через ORM (JPA/Hibernate).

- **Инфраструктурный слой**  
  Включает интеграции с внешними сервисами, файловым хранилищем и средствами безопасности.

---

## 4. Модель данных и база данных

Для хранения структурированных данных используется реляционная база данных.

Основные сущности системы включают:

- пользователь (User);
- предмет (Item);
- описание и характеристики предмета;
- состояние доступности предмета;
- связи между владельцами и арендаторами.

Модель данных спроектирована с учётом нормализации и возможности расширения без изменения базовой структуры.

---

## 5. Работа с объектным хранилищем (S3)

Для хранения бинарных данных (например, изображений предметов) используется **S3-совместимое объектное хранилище**.

В системе реализованы следующие принципы:

- хранение в базе данных только ссылок на объекты;
- изоляция пользовательских файлов;
- контроль доступа к загружаемым ресурсам;
- возможность замены провайдера хранилища без изменения бизнес-логики.

---

## 6. Безопасность и управление доступом

Для обеспечения безопасности системы используется **Spring Security**.

Реализованы следующие механизмы:

- аутентификация пользователей;
- авторизация на уровне ролей и ресурсов;
- защита API от несанкционированного доступа;
- разграничение прав владельцев предметов и других пользователей.

Архитектура безопасности спроектирована таким образом, чтобы быть расширяемой и не зависеть от конкретного способа аутентификации.

---

## 7. Контейнеризация и развёртывание

Система развёртывается с использованием Docker, что обеспечивает:

- воспроизводимость окружения;
- упрощение локальной разработки;
- удобство запуска зависимых сервисов (БД, хранилище);
- изоляцию компонентов приложения.

Контейнеризация рассматривается как обязательный элемент архитектуры, а не вспомогательный инструмент.

---

## 8. Взаимодействие компонентов

Взаимодействие между компонентами системы происходит следующим образом:

- клиент обращается к REST API;
- контроллеры передают запросы в сервисный слой;
- сервисы взаимодействуют с базой данных и объектным хранилищем;
- механизмы безопасности проверяют доступ на каждом этапе обработки запроса.

Такой подход обеспечивает прозрачность, тестируемость и предсказуемость поведения системы.

---

## 9. Выводы по фазе

В рамках второй фазы была сформирована целостная архитектура сервиса шеринга предметов. Определены ключевые компоненты системы, способы хранения данных, механизмы безопасности и подход к развёртыванию.

Принятые архитектурные решения обеспечивают баланс между сложностью реализации, расширяемостью системы и возможностью дальнейшей детальной проработки проекта в следующих фазах.
